<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<title>GIT笑话网 - gitjoke.com</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
<link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
<link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bmob-min.js"></script>
<script type="text/javascript"> Bmob.initialize("4c6dd7eed26e4d1ed7877d6093b299c1", "d5c309d52fd9904e1f85e4f5d5dd72f5");</script>
<!-- Baidu Tongji //-->
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "//hm.baidu.com/hm.js?279eb3fba9f1ccf8f52393aa1b8a0f63";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- Page Loaded //-->
<script type="text/javascript">
$(function() {
	$('footer h5').css("color", "grey");
});
</script>
<script type="text/javascript">
</script>
	<script type="text/javascript">
	function changeImg(objImg)
	{
		//设置最大宽度
		var most = 240;        
		if(objImg.width > most)
		{
			var scaling = 1-(objImg.width-most)/objImg.width;    
			//计算缩小比例
			objImg.width = objImg.width*scaling;
			objImg.height = objImg.height;              	//img元素没有设置高度时将自动等比例缩小
			// objImg.height = objImg.height*scaling;    //img元素设置高度时需进行等比例缩小
		}
	}
	</script>
</head>
<body>
<section class="page-header">
	<h3 class="project-name">GIT笑话网 - gitjoke.com</h3>
</section>
<section class="main-content">

	<!-- stdout //-->
	<p id="idStdout1"></p>
	<p id="idStdout2"><font color=red>正在加载，请稍后......</font></p>
	<p id="idStdout3"><font color=red>正在加载，请稍后......</font></p>

      	<footer class="site-footer">
      	<h5>@ 2016 GIT 笑话网 - gitjoke.com | 隐私声明和 Cookie
      	<a href="http://go.microsoft.com/fwlink/?LinkId=248686&CLCID=804" target=_blank>@</a></h5>
      	</footer>

	<!-- RUN //-->
	<script type="text/javascript">

	// RUN
	funcShowGitJokeAll (0, 2, "#idStdout1");

	// READY
	$(document).ready(function() {
		$.ajax({url:"/get2.html", 
			success:function(msg){
				$("#idStdout2").html (msg);
			}
		});

		$.ajax({url:"/get3.html", 
			success:function(msg){
				$("#idStdout3").html (msg);
			}
		});		
	});

	// GET JOKES
	function funcShowGitJokeAll (iSkipCount, iLimitCount, idStdout){
		var tGitJokeAllTalbe = Bmob.Object.extend ("GitJokeAll");
		var tQuery = new Bmob.Query (tGitJokeAllTalbe);
		var strFullPage = "";
		var strOneLine = "";
		tQuery.descending("createdAt");
		tQuery.skip (iSkipCount);
		tQuery.limit (iLimitCount);
        	tQuery.find({success: function(results) {
			for (var i = 0; i < results.length; i++) {
				var object = results[i];
				var strName = object.get('strName');
				var strContent = object.get('strContent');
				var strImgUrl = object.get('strImgUrl');
				var strColor;
				if (i%6==0||i%6==1){
					strColor = "green";
				} else if (i%6==2||i%6==3) {
					strColor = "blue";
				} else {
					strColor = "red";
				}

				var strNameHtml = "<b><font size=6 color=" + strColor + ">" + strName + "</font></b>";
				var strContentHtml = strContent;
				var strImgUrlHtml = "<img src=\"" + strImgUrl + "\" onload=\"changeImg(this);\">";
				strOneLine = strNameHtml + "</br>" + 
					strContentHtml + "</br>" + 
					strImgUrlHtml + "</br></br>";
				strFullPage += strOneLine;
			}
			$(idStdout).html (strFullPage);			
            	},
            	error: function(error) {
                	$(idStdout).text ("Query failed: " + error.code + " " + error.message);
            	}
        }); 
	}
	</script>

	<script>
	function getUrlParamValueOf (url, name) {
		var reg = new RegExp('(\\?|&)' + name + '=([^&?]*)', 'i');
		var arr = url.match(reg);
		if (arr) {
			return arr[2];
		}
		return null;
	}
	</script>
</section>
</body>
</html>
