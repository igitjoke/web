<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="UTF-8">
<title>GIT笑话 - gitjoke.com</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
<link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
<link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/bmob-min.js"></script>
<script type="text/javascript"> Bmob.initialize("4c6dd7eed26e4d1ed7877d6093b299c1", "d5c309d52fd9904e1f85e4f5d5dd72f5");</script>
<!-- Baidu Tongji //-->
<script>
var _hmt = _hmt || [];
(function() {
	var hm = document.createElement("script");
	hm.src = "//hm.baidu.com/hm.js?279eb3fba9f1ccf8f52393aa1b8a0f63";
	var s = document.getElementsByTagName("script")[0]; 
	s.parentNode.insertBefore(hm, s);
})();
</script>
<!-- Page Loaded //-->
<script type="text/javascript">
$(function() {
	$('footer h5').css("color", "grey");
});
</script>
<script type="text/javascript">
</script>
	<script type="text/javascript">
	function changeImg(objImg)
	{
		var most = 240;
		if (objImg.width > objImg.height) {
			if(objImg.width > most) {
				var scaling = most/objImg.width;    
				objImg.width = objImg.width*scaling;
			} else if (objImg.width < most) {
				var scaling = most/objImg.width;
				objImg.width = objImg.width*scaling;			
			}
		} else {
			if(objImg.height > most) {
				var scaling = most/objImg.height;    
				objImg.height = objImg.height*scaling;
			} else if (objImg.height < most) {
				var scaling = most/objImg.height;
				objImg.height = objImg.height*scaling;			
			}
		}
	}
	</script>
</head>
<body>
<section class="page-header">
	<h3 class="project-name">GIT笑话 - gitjoke.com</h3>
</section>
<section class="main-content">

	<!-- stdout //-->
	<p id="idStdout0"></p>
	<p id="idStdout1">加载中，请稍后片刻......</p>
	<p id="idStdout2"></p>
	<p id="idStdout3"></p>
	<p id="idStdout4"></p>
	<form id="idFormNext">
		<input type="button" id="idHomeBtn" value="第一页" onclick="funcGoHomePage(this);" />
		<input type="button" id="idNextBtn" value="下一页" onclick="funcGoNextPage(this);" />
	</form>

      	<footer class="site-footer">
      	<h5>@ 2016 GIT笑话 - gitjoke.com | 隐私声明和 Cookie
      	<a href="http://go.microsoft.com/fwlink/?LinkId=248686&CLCID=804" target=_blank>@</a></h5>
      	</footer>

	<script>
	function funcGetUrlParamValueOf (url, name) {
		var reg = new RegExp('(\\?|&)' + name + '=([^&?]*)', 'i');
		var arr = url.match(reg);
		if (arr) {
			return arr[2];
		}
		return null;
	}
	</script>

	<script>
	var g_iTotalCount = 0;

	function funcGoHomePage (){
		window.location.href = "/index.html";
	}
	function funcGoNextPage (){
		if (18*(parseInt(g_iPageNo,10)+1) >= g_iTotalCount) {	// 每页18条笑话
			window.location.href = "/index.html";  // 超过则返回第一页
		} else {
			window.location.href = "/index.html?iPageNo=" + (parseInt(g_iPageNo,10)+1);
		}
	}
	</script>

	<!-- RUN //-->
	<script type="text/javascript">

	var g_iPageNo = funcGetUrlParamValueOf (window.location.href, "iPageNo");
	if (!g_iPageNo) {
		g_iPageNo = 0;
	}

	// READY
	$(document).ready(function() {
		setTimeout (function () {
			$.ajax({url:"/get1.html", 
				success:function(msg){
					$("#idStdout1").html (msg);
				}
			});
			$.ajax({url:"/get2.html", 
				success:function(msg){
					$("#idStdout2").html (msg);
				}
			});
			$.ajax({url:"/get3.html", 
				success:function(msg){
					$("#idStdout3").html (msg);
				}
			});
			$.ajax({url:"/getcount.html",
				success:function(msg){
					$("#idStdout0").html (msg);
				}
			});
		}, 0);
	});

	// GET JOKES
	function funcShowGitJokeAll (iSkipCount, iLimitCount, idStdout){
		var tGitJokeAllTalbe = Bmob.Object.extend ("GitJokeAll");
		var tQuery = new Bmob.Query (tGitJokeAllTalbe);
		var strFullPage = "";
		var strOneLine = "";
		tQuery.descending("createdAt");
		tQuery.skip (iSkipCount);
		tQuery.limit (iLimitCount);
        	tQuery.find({success: function(results) {
			for (var i = 0; i < results.length; i++) {
				var object = results[i];
				var strName = object.get('strName');
				var strContent = object.get('strContent');
				var strImgUrl = object.get('strImgUrl');
				var strGodComment = object.get('strGodComment');
				var strColor;
				if (i%6==0||i%6==1){
					strColor = "green";
				} else if (i%6==2||i%6==3) {
					strColor = "blue";
				} else {
					strColor = "black";
				}

				var strNameHtml = "<b><font size=6 color=" + strColor + ">" + strName + "</font></b>";
				var strContentHtml = strContent;
				var strImgUrlHtml = "<img src=\"" + strImgUrl + "\" onload=\"changeImg(this);\">";
				var strGodCommentHtml = "&nbsp; &nbsp; &nbsp; &nbsp;<b><font color=red>网友评论: " + strGodComment + "</font></b>";
				if (!strGodComment) {
					strGodCommentHtml = "";
				}

				strOneLine = strNameHtml + "</br>" + 
					strContentHtml + "</br>" + 
					"&nbsp; &nbsp; &nbsp; &nbsp;" + strImgUrlHtml + "</br>" +
					strGodCommentHtml + "</br></br>";
				strFullPage += strOneLine;
			}
			$(idStdout).html (strFullPage);			
            	},
            	error: function(error) {
                	$(idStdout).text ("Query failed: " + error.code + " " + error.message);
            	}
        }); 
	}
	</script>

	<script>
	function funcGetCount() {
		var tGitJokeAllTalbe = Bmob.Object.extend ("GitJokeAll");
		var tQuery = new Bmob.Query (tGitJokeAllTalbe);
		tQuery.count({
			success: function(iTotalCount) {
				g_iTotalCount = iTotalCount;
				var strShowPageInfo = "我们至今已收录<font color=blue size=6>" + iTotalCount + "</font>条笑话，" +
					"共"+(Math.ceil(parseInt(iTotalCount,10)/18))+"页，当前第<font color=blue size=6>"+ (parseInt(g_iPageNo,10)+1) +"</font>页。" +
					"<font color=red><b>本站拟征笑话配音，男女声不限，以沙哑又甜美、野性又婉约为最佳，每个壹佰元起，请关注本站后续通告。</b></font>";
				$("#idStdout0").html (strShowPageInfo);
				$("#idStdout4").html (strShowPageInfo);
			},
			error: function(error) {
				$("#idStdout0").text (error.message);
				$("#idStdout4").text (error.message);
			}
		}); 
	}
	</script>
</section>
</body>
</html>
